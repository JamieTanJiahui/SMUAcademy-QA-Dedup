<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMUAcademy Deduplication</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Firebase -->
    <script type="module">
        import {db, getFirestore, collection, doc, setDoc } from '../js/database.js'

        // Vue Application
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    formData: {
                        group: "",
                        title: "",
                        objective: "",
                        description: ""
                    }
                };
            },
            methods: {
                async addCourse() {
                    if (!this.formData.group || !this.formData.title) {
                        alert("Please select a group and enter a title.");
                        return;
                    }

                    try {
                        // Reference to the specific group and course title
                        const groupRef = doc(db, this.formData.group, this.formData.title);
                        
                        // Set the course data in Firestore
                        await setDoc(groupRef, {
                            title: this.formData.title,
                            objective: this.formData.objective,
                            description: this.formData.description
                        });

                        alert("Course added successfully!");
                        this.resetForm();
                    } catch (error) {
                        console.error("Error adding course: ", error);
                        alert("Failed to add course. Please try again.");
                    }
                },
                resetForm() {
                    this.formData = {
                        group: "",
                        title: "",
                        objective: "",
                        description: ""
                    };
                }
            }
        }).mount("#app");
    </script>
</head>

<body>
    <div id="app" class="container mt-5">
        <h1 class="text-center mb-4">Add in a Course</h1>
        <form @submit.prevent="addCourse" class="bg-light p-4 rounded shadow-sm">
            <div class="mb-3">
                <label for="group" class="form-label">Group</label>
                <select v-model="formData.group" id="group" name="group" class="form-select" required>
                    <option value="">Select a group</option>
                    <option value="HCML">HCML</option>
                    <option value="FIT">FIT</option>
                    <option value="BM">BM</option>
                    <option value="SOBI">SOBI</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="title" class="form-label">Title</label>
                <input v-model="formData.title" type="text" id="title" name="title" class="form-control"
                    placeholder="Enter the title" required>
            </div>

            <div class="mb-3">
                <label for="objective" class="form-label">Objective</label>
                <textarea v-model="formData.objective" id="objective" name="objective" class="form-control"
                    placeholder="Enter the objective" rows="3" required></textarea>
            </div>

            <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea v-model="formData.description" id="description" name="description" class="form-control"
                    placeholder="Enter the description" rows="5" required></textarea>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </div>
</body>

</html>
